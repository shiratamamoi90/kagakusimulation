<!DOCTYPE>
<html lang="ja">
<head>
  <meta charset="UTF-8"/>
  <title>TENTAI</title>
</head>
<body>
<input type="button" value="start" onclick="start()">
<br>
<canvas id="c1" width="1000px" height="1000px" style="position:absolute; z-index:0"></canvas>
<canvas id="c2" width="1000px" height="1000px" style="position:absolute; z-index:1"></canvas>
<script type="text/javascript">
  var c1 = document.getElementById('c1');
  var ctx1 = c1.getContext("2d");
  var c2 = document.getElementById('c2');
  var ctx2 = c2.getContext("2d");

  var vx = [0, 0];
  var vy = [-10.0, -10.0];
  var messx = [600, 700];
  var messy = [500, 500];
  var mess = [1.0, 10.0];
  var g = 10.0, dt = 1.0, r1, fx, fy;
  var x = 500, y = 500, m = 1000.0;

  p1 = ctx2.createImageData(1, 1);
  p1.data[0] = 255;
  p1.data[1] = 0;
  p1.data[2] = 0;
  p1.data[3] = 255;

  function update(){
    tentai(0);

    tentai(1);

    tid = setTimeout("update()", 50);
  }

  function tentai(i) {
    r1 = Math.sqrt((messx[i]-x)*(messx[i]-x) + (messy[i]-y)*(messy[i]-y));

    fx = (-1)*mess[i]*m*g*(messx[i]-x)/(r1*r1*r1);
    fy = (-1)*mess[i]*m*g*(messy[i]-y)/(r1*r1*r1);

    messx[i] = messx[i] + vx[i]*dt;
    vx[i] = vx[i] + fx*dt
    messy[i] = messy[i] + vy[i]*dt;
    vy[i] = vy[i] + fy*dt;

    console.log(messx[i], messy[i]);

    ctx2.putImageData(p1, messx[i], messy[i]);
  }

  function first() {
    ctx1.fillStyle = "black";
    ctx1.fillRect(0, 0, 1000, 1000);

    ctx1.fillStyle = "#0080ff";
    ctx1.beginPath();
    ctx1.arc(x, y, 24, 0, Math.PI*2, true);
    ctx1.fill();
  }

  function start() {
    update();
  }

  first();
</script>
</body>
</html>
