<!DOCTYPE>
<html lang="ja">
<head>
  <meta charset="UTF-8"/>
  <title>TENTAI</title>
</head>
<body>
<input type="button" value="start" onclick="start()">
<br>
<canvas id="c1" width="1500px" height="1000px" style="position:absolute; z-index:0"></canvas>
<canvas id="c2" width="1500px" height="1000px" style="position:absolute; z-index:1"></canvas>
<script type="text/javascript">
  var c1 = document.getElementById('c1');
  var ctx1 = c1.getContext("2d");
  var c2 = document.getElementById('c2');
  var ctx2 = c2.getContext("2d");

　var planet_v = [];//各惑星の速度
  var planet_vx = [0, 0, 0, 0, 0, 0, 0, 0];
  var planet_vy = [-10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0, -10.0];
  var planet_x = [788, 822, 850, 902, 1270, 1755, 2921, 4011];//各惑星の座標
  var planet_y = [500, 500, 500, 500, 500, 500, 500, 500];
  var planet_fx;
  var planet_fy;
  var planet_m = [0.05, 8.1, 1, 0.11, 317, 95, 14, 17];//各惑星の重さ
  var x = 750, y = 500, m = 33000000000.0;//太陽の座標、重さ
  var vx = 0, vy = 0;
  var G = 6.7;//重力定数
  var dt = 0.1;//時間刻み
  var pi = 0;

  p1 = ctx2.createImageData(1, 1);
  p1.data[0] = 255;
  p1.data[1] = 0;
  p1.data[2] = 0;
  p1.data[3] = 255;

  function update(){
    tentai(0);
    tentai(1);
    tentai(2);
    tentai(3);


    tid = setTimeout("update()", 50);
  }

  function tentai(i) {
    var r, xx, yy;

    xx = planet_x[i] - x;
    yy = planet_y[i] - y;

    r = Math.sqrt(xx*xx + yy*yy);

    planet_fx = -1 * planet_m[i]*m*G*xx/(r*r*r);
    planet_fy = -1 * planet_m[i]*m*G*yy/(r*r*r);

    planet_x[i] = planet_x[i] + planet_vx[i]*dt;
    planet_vx[i] = planet_vx[i] + planet_fx*dt;
    planet_y[i] = planet_y[i] + planet_vy[i]*dt;
    planet_vy[i] = planet_vy[i] + planet_fy*dt;
    x = x + vx*dt;
    vx = vx + ((-1) * planet_fx * dt);
    y = y + vy*dt;
    vy = vy + ((-1) * planet_fy * dt);

    ctx2.putImageData(p1, planet_x[i], planet_y[i]);
  }

  function first() {
    ctx1.fillStyle = "black";
    ctx1.fillRect(0, 0, 2000, 1000);

    ctx1.fillStyle = "#0080ff";
    ctx1.beginPath();
    ctx1.arc(x, y, 20, 0, Math.PI*2, true);
    ctx1.fill();
  }

  function start() {
    update();
  }

  first();
</script>
</body>
</html>
